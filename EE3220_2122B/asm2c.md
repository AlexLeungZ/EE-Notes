# Reverse engineering Assembly to C

## Step 1 Install retdec

```bash
sudo apt install xz-utils wget
wget https://github.com/avast/retdec/releases/download/v4.0/retdec-v4.0-ubuntu-64b.tar.xz
tar xf retdec-v4.0-ubuntu-64b.tar.xz
```

## Step 2 Install gcc-arm-linux-gnueabihf (arm v7)

```bash
sudo apt install gcc-arm-linux-gnueabihf binutils-arm-linux-gnueabihf binutils-arm-linux-gnueabihf-dbg
```

## Step 2A Install gcc-arm-linux-gnueabihf (arm v8)

```bash
sudo apt install gcc-aarch64-linux-gnu binutils-aarch64-linux-gnu binutils-aarch64-linux-gnu-dbg
```

## Step 3 Input Assembly

```bash
touch bar.s
nvim bar.s # Or use whatever IDE you like
```

Add the following as the head of the Assembly

```assembly
.section .text
.global bar
```

Then the remain of the question / code

```assembly
bar:
        push {r4, r5, r11, lr}
        add r11, sp, #8
        mov r4, r0
        mov r0, #1
        cmp r4, #2
        blo .LBB0_2
        sub r0, r4, #1
        bl bar
        mov r5, r0
        sub r0, r4, #2
        bl bar
        mul r0, r0, r5
        add r0, r0, #3
.LBB0_2:
        pop {r4, r5, r11, pc}
```

Save and quit NVIM

```bash
:wq!
```

## Step 4 Assembly to C (arm V7)

```bash
arm-linux-gnueabihf-as bar.s -o bar.o
arm-linux-gnueabihf-ld bar.o -o bar
~/PATH_TO_RETDEC/retdec/bin/retdec-decompiler.py bar
```

## Step 4A Assembly to C (arm V8)

```bash
aarch64-linux-gnu-as bar.s -o bar.o
aarch64-linux-gnu-ld bar.o -o bar
~/PATH_TO_RETDEC/retdec/bin/retdec-decompiler.py bar
```

## Step 5 View C output in NVIM

```bash
nvim bar.c # Or use whatever IDE you like
```

## Result

```c
//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>

// ------------------- Function Prototypes --------------------

int32_t _24_a(uint32_t a1);

// ------------------------ Functions -------------------------

// Address range: 0x10054 - 0x1008c
int32_t _24_a(uint32_t a1) {
    int32_t result = 1; // 0x10068
    if (a1 >= 2) {
        int32_t v1 = _24_a(a1 - 1); // 0x10070
        result = _24_a(a1 - 2) * v1 + 3;
    }
    // 0x10088
    return result;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gc
// Detected functions: 1
```
